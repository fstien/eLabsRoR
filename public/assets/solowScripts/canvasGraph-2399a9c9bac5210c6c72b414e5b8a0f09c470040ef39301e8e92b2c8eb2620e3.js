function gameLoop(){requestAnimFrame(gameLoop),drawScreen()}function drawScreen(){if(title.update(),v.round10000("alpha"),v.round10000("savings"),v.round10000("dep"),v.round10000("tech"),key=(oldWidth*GraphCanvasDisplayRatio-GraphCanvasDisplayRatio*(padding.left+padding.right))/((canvasLogicConstants.width-(padding.left+padding.right))*GraphCanvasDisplayRatio),v.unit=(oldHeight*GraphCanvasDisplayRatio/GraphCanvasDisplayRatio-padding.bottom-unitFunc())/key,desktop){for(clickTrue&&(m.g.stringColorClick===v.d.color.string&&(dragUpdate("dep",plotRY(m.g.pos.y)/plotRX(m.g.pos.x),1,!0),dragTitle("dep")),m.g.stringColorClick===v.s.color.string&&(dragUpdate("savings",plotRY(m.g.pos.y)/(v.tech*Math.pow(plotRX(m.g.pos.x),v.alpha)),1,!0),dragTitle("savings")),m.g.stringColorClick===v.t.color.string&&(dragUpdate("tech",plotRY(m.g.pos.y)/Math.pow(plotRX(m.g.pos.x),v.alpha),v.t.max,!0),dragTitle("tech")),m.g.stringColorClick===v.P2Color.string&&(dragUpdate("tech",plotRY(m.g.pos.y)/Math.pow(plotRX(m.g.pos.x),v.alpha),v.t.max,!1),v.savings=plotRX(m.g.pos.x)*v.dep/plotRY(m.g.pos.y),document.getElementById("savingsInput").value=v.savings,v.P2Bonus=v.bonusSize),m.g.stringColorClick===v.P1Color.string&&(dragUpdate("dep",plotRY(m.g.pos.y)/plotRX(m.g.pos.x),1,!1),dragUpdate("savings",plotRY(m.g.pos.y)/(v.tech*Math.pow(plotRX(m.g.pos.x),v.alpha)),1,!1),v.P1Bonus=v.bonusSize),rescaleStatus=scaleStatus()),"canvasGraph"===m.tag&&(m.newCursor="auto"),(m.g.stringColor===v.s.color.string||m.g.stringColor===v.d.color.string||m.g.stringColor===v.t.color.string||m.g.stringColor===v.P2Color.string||m.g.stringColor===v.P1Color.string||clickTrue&&(m.g.stringColorClick===v.s.color.string||m.g.stringColorClick===v.d.color.string||m.g.stringColorClick===v.t.color.string||m.g.stringColorClick===v.P2Color.string||m.g.stringColorClick===v.P1Color.string))&&(m.newCursor="pointer"),rescaleStatus&&(m.newCursor="not-allowed",rescaleStatus=scaleStatus()),m.newCursor!==m.cursor&&(m.cursor=m.newCursor,$("body").css("cursor",m.cursor)),"canvasGraph"===m.tag&&(curveHoverLineEase("t","P2Color"),curveHoverLineEase("s","P1Color"),curveHoverLineEase("d","P1Color")),i=1;i<=3;i++)easeControl(v[v.property(i+4)].lineEasing,v[v.property(i+4)].lineRatio),lineEaseLoop(v[v.property(i+4)].lineEasing,v.property(i));v.s.color.g=color.Init+Math.round(color.darken*(v.s.lineRatio-1+v.s.clickBonus)),v.d.color.b=color.Init+Math.round(color.darken*(v.d.lineRatio-1+v.d.clickBonus)),v.t.color.r=color.Init+Math.round(color.darken*(v.t.lineRatio-1+v.t.clickBonus)),v.P1Color.g=v.P1Color.b=color.Init+Math.round(color.darken*(v.t.lineRatio-1+v.t.clickBonus)),v.P2Color.r=v.P2Color.g=color.Init+Math.round(color.darken*(Math.max(v.d.lineRatio,v.s.lineRatio)-1+Math.max(v.d.clickBonus,v.s.clickBonus)))}for(i=0;i<=3;i++)v[Object.keys(v)[i]]=round10000(document.getElementById(Object.keys(v)[i]+"Input").value);for(now=Date.now(),v.a.shift["switch"]&&shiftEaseLoop("a","alpha",0,1),v.s.shift["switch"]&&shiftEaseLoop("s","savings",0,1),v.d.shift["switch"]&&shiftEaseLoop("d","dep",0,1),v.t.shift["switch"]&&shiftEaseLoop("t","tech",0,v.t.max),scaleSwitch&&(scaleTime=Date.now(),scaleClock=scaleTime-scaleStartTime,ID.scale=easeOutCubic(scaleClock,scaleStart,scaleDistance,duration),scaleClock>=duration&&(scaleSwitch=!1,ID.scale=scaleT,$("input").css("cursor","pointer")),graphScale=ID.height*ID.scale/10),"equationsDiv"!==m.tag&&equationUpdate(),i=0;i<=3;i++)for(eq=0;eq<=ease.equation.ID.length-1;eq++)null!==document.getElementById(ease.equation.ID[eq]+Object.keys(v)[i])&&convertSym($("#"+ease.equation.ID[eq]+Object.keys(v)[i]).html())!==v[Object.keys(v)[i+4]][ease.equation.ID[eq]]&&$("#"+ease.equation.ID[eq]+Object.keys(v)[i]).html(v[Object.keys(v)[i+4]][ease.equation.ID[eq]]);ease.zoom.allowUpdate(),max.compute(),inter.compute(),hypoInter.compute(),box.update("k",inter.a.x),box.update("y",inter.b.y),box.update("c",inter.b.y-inter.a.y),box.update("i",inter.a.y),box.update("MPK",v.tech*v.alpha*Math.pow(inter.a.x,v.alpha-1)),whiteRefresh(),showAxes(),dottedIndex(),desktop&&unitIndex(1),Graph(function(e){return v.tech*Math.pow(e,v.alpha)},rgbString(v.t.color),1,lineWidth.graph*(v.t.lineRatio+v.t.clickBonus)),Graph(function(e){return v.tech*v.savings*Math.pow(e,v.alpha)},rgbString(v.s.color),1,lineWidth.graph*(v.s.lineRatio+v.s.clickBonus)),Graph(function(e){return v.dep*e},rgbString(v.d.color),1,lineWidth.graph*(v.d.lineRatio+v.d.clickBonus)),inter.b.x<max.x&&inter.b.y<max.y&&Point(plotX(inter.b.x),plotY(inter.b.y),rgbString(v.P1Color),.6*lineWidth.graph*(v.t.lineRatio+v.P2Bonus)),inter.a.x<max.x&&inter.a.y<max.y&&Point(plotX(inter.a.x),plotY(inter.a.y),rgbString(v.P2Color),.6*lineWidth.graph*(Math.max(v.d.lineRatio,v.s.lineRatio)+v.P1Bonus))}var canvasGraph=document.getElementById("canvasGraph"),context1=canvasGraph.getContext("2d"),canvasLogic={width:1e3,height:700},canvasLogicConstants={width:canvasLogic.width,height:canvasLogic.height},devicePixelRatio=window.devicePixelRatio||1,backingStoreRatio=context1.webkitBackingStorePixelRatio||context1.mozBackingStorePixelRatio||context1.msBackingStorePixelRatio||context1.oBackingStorePixelRatio||context1.backingStorePixelRatio||1,GraphCanvasDisplayRatio=devicePixelRatio/backingStoreRatio*1,menuHeight=70;$("#Menu").height(menuHeight);var padding={top:40,bottom:70,left:70,right:50},color={g1:20,g2:40,g3:100,Init:220,darken:60},maxResize=Math.round($(window).width()-($(window).height()-menuHeight)*(canvasLogic.width/canvasLogic.height));if(desktop){var minPanel=330,defaultSize=12*Math.sqrt($(window).width());minPanel>defaultSize&&(defaultSize=minPanel);var splitter={minSize:minPanel,size:defaultSize,maxSize:1.4*defaultSize,divSize:10};splitter.maxSize=splitter.size>maxResize?splitter.size:maxResize;var myLayout=$("#container").layout({center:{maxSize:1e3},east:{spacing_open:splitter.divSize,resizerDragOpacity:.5,size:splitter.size,minSize:splitter.minSize,maxSize:splitter.maxSize,closable:!1,livePaneResizing:!0,resizerCursor:"col-resize",onresize:function(){resizecanvasGraph(),resizecanvasControls()}}}),divGraph={width:myLayout.center.state.layoutWidth,height:$(window).height()-menuHeight}}else{padding.left=20,padding.right=20,padding.bottom=20,padding.top=20,$("#rangeControl").css("display","none");var divGraph={width:$(window).width(),height:$(window).height()-menuHeight}}var ratio={curves:(canvasLogic.height-(padding.top+padding.bottom))/(canvasLogic.width-(padding.left+padding.right)),canvasGraph:canvasLogic.height/canvasLogic.width,div:divGraph.height/divGraph.width},ID={width:canvasLogic.width-(padding.left+padding.right),height:canvasLogic.height-(padding.top+padding.bottom),axesColor:grey(color.g2),lineBasis:1.5,lineGraphRatio:1.2,scale:1.1},v={alpha:document.getElementById("alphaInput").value,savings:document.getElementById("savingsInput").value,dep:document.getElementById("depInput").value,tech:document.getElementById("techInput").value,a:{shift:{"switch":!1,startTime:0,current:0,sStart:0,distance:0},EqProd:"&alpha;",EqSS:"&alpha;",save:document.getElementById("alphaInput").value},s:{lineEasing:{switch1:!1,switch2:!1,Large:!1,easeLarge:!1},shift:{"switch":!1,startTime:0,current:0,sStart:0,distance:0},color:{r:0,g:color.Init,b:0,string:"green"},EqSS:" s ",lineRatio:1,clickBonus:0,save:document.getElementById("savingsInput").value},d:{lineEasing:{switch1:!1,switch2:!1,Large:!1,easeLarge:!1},shift:{"switch":!1,startTime:0,current:0,sStart:0,distance:0},color:{r:0,g:0,b:color.Init,string:"blue"},EqSS:"&delta;",lineRatio:1,clickBonus:0,save:document.getElementById("depInput").value},t:{lineEasing:{switch1:!1,switch2:!1,Large:!1,easeLarge:!1},shift:{"switch":!1,startTime:0,current:0,sStart:0,distance:0},max:$("#techInput").prop("max"),color:{r:color.Init,g:0,b:0,string:"red"},EqProd:" A ",EqSS:" A ",lineRatio:1,clickBonus:0,save:document.getElementById("techInput").value},round10000:function(e){this[e]=round10000(this[e])},IDscaleSave:ID.scale,P1Color:{r:0,g:color.Init,b:color.Init,string:"yellow"},P2Color:{r:color.Init,g:color.Init,b:0,string:"cyan"},P1Bonus:0,P2Bonus:0,bonusSize:.2,keyVar:["k","y","c","i","MPK"],unit:(canvasGraph.height/GraphCanvasDisplayRatio-padding.bottom-unitFunc())/key,property:function(e){return Object.keys(this)[e]},index:function(e){if(this.hasOwnProperty(e))for(i=0;i<=7;i++)if(Object.keys(this)[i]===e)return i},colorConvert:function(e){switch(e){case this.s.color.string:return"savings";case this.d.color.string:return"dep";case this.t.color.string:return"tech"}},midName:function(e){switch(e){case"a":return"alpha";case"s":return"savings";case"d":return"dep";case"t":return"tech"}},fullName:function(e){switch(e){case"alpha":return"alpha";case"savings":return"savings";case"dep":return"depreciation";case"tech":return"technology"}}},m={tag:"canvasGraph",alphaHover:!1,cursor:"auto",newCursor:"auto",g:{pos:{x:100,y:100},rgb:"",stringColor:"",stringColorClick:""},c:{pos:{x:"",y:""},touch:{}}},ease={shift:{size:.1,speed:300,savingsRatio:1.2,proportionA:.1},lineWidth:{size:1.3,duration:2e3},equation:{updateRatio:.8,hoverSpeed:200,ID:["EqProd","EqSS"]},zoom:{allowIn:!0,proportion:.2,allowUpdate:function(){this.inAllow=plotX(inter.b.x*(1+ease.zoom.proportion))>plotX(max.x)||plotY(inter.b.y*(1+ease.zoom.proportion))<plotY(max.y)?!1:!0},ease:function(e){rescaleRefreshAllow&&(scaleT=ID.scale*e,scaleStart=ID.scale,scaleDistance=scaleT-ID.scale,scaleStartTime=Date.now(),duration=300,scaleSwitch=!0)}}},inter={a:{},b:{},compute:function(){this.a.x=Math.pow(v.dep/(v.savings*v.tech),1/(v.alpha-1)),this.a.y=v.savings*v.tech*Math.pow(v.dep/(v.savings*v.tech),v.alpha/(v.alpha-1)),this.b.x=Math.pow(v.dep/(v.savings*v.tech),1/(v.alpha-1)),this.b.y=v.tech*Math.pow(v.dep/(v.savings*v.tech),v.alpha/(v.alpha-1))}},hypoInter={a:{savings:{increase:{},decrease:{}},depreciation:{increase:{},decrease:{}},technology:{increase:{},decrease:{}}},b:{savings:{increase:{},decrease:{}},depreciation:{increase:{},decrease:{}},technology:{increase:{},decrease:{}}},compute:function(){hypoUpdate()}},max={x:round10000(ID.width/(v.unit*key)),y:round10000(ID.height/(v.unit*key)),compute:function(){this.x=round10000(ID.width/(v.unit*key)),this.y=round10000(ID.height/(v.unit*key))}},box={k:"k",y:"y",c:"c",i:"i",MPK:"MPK",update:function(e,t){box[e]=round100fixed(t),$("#var-"+e).text()!==e+": "+box[e]&&$("#var-"+e).text(e+": "+box[e])}},title={p:$("#textTitle").text(),t:"","switch":!1,setTransStatus:function(e){this["switch"]=!0,this.t=e},revertTransStatus:function(){this["switch"]=!1},upgradeStatus:function(e,t){this.p=this.t,this["switch"]=!1,ajax(e,t)},value:function(){return this["switch"]?this.t:this.p},update:function(){$("#textTitle").text()!==this.value()&&$("#textTitle").text(this.value())}},text={alpha:{increase:"Increase in Alpha",decrease:"Decrease in Alpha"},dep:{increase:"Increase in Depreciation",decrease:"Decrease in Depreciation",curve:"The Depreciation Function"},savings:{increase:"Increase in Savings",decrease:"Decrease in Savings",curve:"The Savings Function"},tech:{increase:"Technological progress",decrease:"Technological decline",curve:"The Production Function"},inputVar:{alpha:"Alpha",savings:"The Savings Rate",dep:"The Depreciation Rate",tech:"Technology/Labour efficiency"},keyVar:{k:"Steady-State Capital/Worker",k2:"Steady-State Capital/Worker",y:"Steady-State Output/Worker",c:"Steady-State Consumption/Worker",i:"Steady-State Investment/Worker",MPK:"Marginal Product of Capital"},equations:{EqProd:["y","k","tech","alpha"],EqSS:["savings","tech","k","alpha","dep","k2"]},curvePad:.05,varAccess:function(e){for(index in this.inputVar)if(index===e)return"inputVar";for(index2 in this.keyVar)if(index2===e)return"keyVar"},hashHandler:function(e){return this.inputVar.hasOwnProperty(e)?v.fullName(e):this.keyVar[e].replace(/\s+/g,"").replace("/","")}},font={equation:{basis:19,XS:.75,S:.95,L:1.05,XL:1.1},symbol:19,table:18,title:{weight:700,size:20},content:16};$("#equationsDiv").css({"font-size":font.equation.basis}),$(".symbolText").css("fontSize",font.symbol),$(".data").css("fontSize",font.table),$("#textTitle").css("fontSize",font.title.size),$("#textTitle").css("font-weight",font.title.weight),$("#textDiv").css("fontSize",font.content);var now=Date.now(),scaleT=ID.scale,lineWidth={axes:0,graph:0},sizeLimit={width:200,height:400},textSize,textString;for(equationHover(),$("#alphaInput").mouseenter(function(){v.t.lineEasing.Large=!0,m.alphaHover=!0}),$("#alphaInput").mouseleave(function(){v.t.lineEasing.Large=!1,setTimeout(function(){m.alphaHover=!1},500*ease.equation.updateRatio)}),i=1;i<4;i++)!function(e){$("#"+Object.keys(v)[e]+"Input").mouseenter(function(){v[Object.keys(v)[e+4]].lineEasing.Large=!0}),$("#"+Object.keys(v)[e]+"Input").mouseleave(function(){v[Object.keys(v)[e+4]].lineEasing.Large=!1})}(i);var sliderDown=!1;for(i=0;i<4;i++)!function(e){$("#"+Object.keys(v)[e]+"Input").on("change",rescale),$("#"+Object.keys(v)[e]+"Input").on("mousedown",function(){refValue=v[Object.keys(v)[e]],sliderDown=!0}),$("#"+Object.keys(v)[e]+"Input").on("mousemove",function(){sliderDown&&title.setTransStatus(refValue<v[Object.keys(v)[e]]?text[Object.keys(v)[e]].increase:text[Object.keys(v)[e]].decrease)}),$("#"+Object.keys(v)[e]+"Input").on("mouseup",function(){sliderDown=!1,refValue<v[Object.keys(v)[e]]?title.upgradeStatus(window.location.pathname+"-"+v.property(e)+"-increase",v.fullName(v.property(e))+"-increase"):title.upgradeStatus(window.location.pathname+"-"+v.property(e)+"-decrease",v.fullName(v.property(e))+"-decrease")})}(i);for(i=0;i<v.keyVar.length;i++)!function(e){$("#var-"+v.keyVar[e]).mouseenter(function(){title.setTransStatus(text.keyVar[v.keyVar[e]])}),$("#var-"+v.keyVar[e]).mousedown(function(){title.upgradeStatus(window.location.pathname+"-"+v.keyVar[e],text.keyVar[v.keyVar[e]].replace(/\s+/g,"").replace("/",""))})}(i);for($("#tableContainerDiv").mouseleave(function(){title.revertTransStatus()}),i=0;i<4;i++)!function(e){$("#"+v.property(e)+"InputSymbol").mouseenter(function(){title.setTransStatus(text.inputVar[v.property(e)])}),$("#"+v.property(e)+"InputSymbol").mousedown(function(){title.upgradeStatus(window.location.pathname+"-"+v.property(e),v.fullName(v.property(e)))})}(i);$(".sliderRow").mouseleave(function(){title.revertTransStatus()});for(Eq in text.equations)!function(e){for(i=0;i<text.equations[e].length;i++)!function(t){$("#"+e+text.equations[e][t]).mouseenter(function(){title.setTransStatus(text[text.varAccess(text.equations[e][t])][text.equations[e][t]])}),$("#"+e+text.equations[e][t]).mousedown(function(){title.upgradeStatus(window.location.pathname+"-"+text.equations[e][t],text.hashHandler(text.equations[e][t]))})}(i);$("#"+e).mouseleave(function(){title.revertTransStatus()})}(Eq);if($("input").on("input",function(){rescaleStatus=scaleStatus(),rescaleStatus?$("input").css("cursor","not-allowed"):$("input").css("cursor","pointer")}),desktop){var rgbObj,message3,p,rescaleStatus=!1,mousePos={x:0,y:0},tags=["canvasGraph","canvasControls","equationsDiv","sliderDiv","Menu"];for(idx=0;idx<=tags.length-1;idx++)!function(e){$("#"+tags[e]).mouseenter(function(){m.tag=tags[e]})}(idx);canvasGraph.addEventListener("mousemove",function(e){m.g.pos=getMousePos(canvasGraph,e),p=context1.getImageData(GraphCanvasDisplayRatio*m.g.pos.x,GraphCanvasDisplayRatio*m.g.pos.y,1,1).data,m.g.rgb="rgb("+p[0]+","+p[1]+","+p[2]+")",rgbObj={r:p[0],g:p[1],b:p[2]},m.g.stringColor!==colorString(rgbObj)&&clickTrue===!1&&(m.g.stringColor=colorString(rgbObj),void 0!=text[v.colorConvert(m.g.stringColor)]?title.setTransStatus(text[v.colorConvert(m.g.stringColor)].curve):title.revertTransStatus())},!1);var clickTrue=!1,refValue;canvasGraph.addEventListener("mousedown",function(){clickTrue=!0,m.g.stringColorClick=m.g.stringColor,refValue=v[v.colorConvert(m.g.stringColorClick)]},!1),canvasGraph.addEventListener("mouseup",function(){clickTrue=!1,rescale(),v.s.clickBonus=v.d.clickBonus=v.t.clickBonus=v.P1Bonus=v.P2Bonus=0,void 0!=v.colorConvert(m.g.stringColorClick)&&(refValue*(1+text.curvePad)<v[v.colorConvert(m.g.stringColorClick)]?title.upgradeStatus(window.location.pathname+"-"+v.colorConvert(m.g.stringColorClick)+"-increase",v.fullName(v.colorConvert(m.g.stringColorClick))+"-increase"):refValue*(1-text.curvePad)>v[v.colorConvert(m.g.stringColorClick)]?title.upgradeStatus(window.location.pathname+"-"+v.colorConvert(m.g.stringColorClick)+"-decrease",v.fullName(v.colorConvert(m.g.stringColorClick))+"-decrease"):title.upgradeStatus(window.location.pathname+"-"+v.colorConvert(m.g.stringColorClick)+"-function",v.fullName(v.colorConvert(m.g.stringColorClick))+"-function"))},!1)}resizecanvasGraph(),window.addEventListener("resize",resizecanvasGraph,!1),gameLoop();